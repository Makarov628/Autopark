# Генератор тестовых данных для Autopark

Утилита для генерации тестовых данных предприятий с машинами и водителями для системы Autopark.

## Возможности

- Генерация предприятий с случайными названиями и адресами
- Создание машин с различными характеристиками (марка, модель, цена, пробег, цвет, номер)
- Генерация водителей с привязкой к машинам
- Настройка соотношения машин с активными водителями
- Сохранение данных в JSON формате

## Установка и запуск

### Требования

- .NET 8.0
- Доступ к проекту Domain

### Сборка

```bash
cd DataGenerator
dotnet build
```

### Запуск

```bash
dotnet run -- --enterprises <количество> --vehicles <количество> [опции]
```

## Параметры командной строки

| Параметр                 | Короткий | Обязательный | Описание                                               | По умолчанию          |
| ------------------------ | -------- | ------------ | ------------------------------------------------------ | --------------------- |
| `--enterprises`          | `-e`     | ✅           | Количество предприятий для генерации                   | -                     |
| `--vehicles`             | `-v`     | ✅           | Количество машин на предприятие                        | -                     |
| `--drivers-ratio`        | `-d`     | ❌           | Доля водителей от общего количества машин (0.0-1.0)    | 0.8 (80%)             |
| `--active-drivers-ratio` |          | ❌           | Доля машин с активными водителями (0.0-1.0)            | 0.1 (10%)             |
| `--output`               | `-o`     | ❌           | Путь к файлу для сохранения данных                     | `generated_data.json` |
| `--seed`                 | `-s`     | ❌           | Seed для генератора случайных чисел                    | 12345                 |
| `--to-db`                |          | ❌           | Импортировать данные в базу данных                     | false                 |
| `--connection`           |          | ❌           | Строка подключения к базе данных (SqlServer)           | -                     |
| `--truncate`             |          | ❌           | Очистить таблицы перед импортом в БД                   | false                 |
| `--additional-users`     |          | ❌           | Количество дополнительных пользователей (не водителей) | 0                     |

## Примеры использования

### Базовый пример

```bash
dotnet run -- --enterprises 5 --vehicles 10
```

Создаст 5 предприятий, каждое с 10 машинами, 10% машин будут иметь активных водителей.

### Расширенный пример

```bash
dotnet run -- --enterprises 3 --vehicles 15 --drivers-ratio 0.15 --output test_data.json --seed 42
```

Создаст 3 предприятия, каждое с 15 машинами, 15% машин будут иметь активных водителей, сохранит в файл `test_data.json` с seed 42.

### Генерация большого объема данных

```bash
dotnet run -- --enterprises 10 --vehicles 50 --drivers-ratio 0.2 --output large_dataset.json
```

Создаст 10 предприятий, каждое с 50 машинами, 20% машин будут иметь активных водителей.

### Генерация с правильной логикой водителей

```bash
dotnet run -- --enterprises 2 --vehicles 5 --drivers-ratio 0.8 --active-drivers-ratio 0.2 --additional-users 10
```

Создаст 2 предприятия, каждое с 5 машинами, 80% водителей от машин (8 водителей), 20% активных водителей (2 привязаны к машинам), плюс 10 дополнительных пользователей.

### Импорт в базу данных

```bash
dotnet run -- --enterprises 2 --vehicles 5 --to-db --connection "Server=localhost;Database=Autopark;User Id=sa;Password=your_password;TrustServerCertificate=True;"
```

### Импорт с очисткой таблиц

```bash
dotnet run -- --enterprises 2 --vehicles 5 --to-db --truncate --connection "Server=localhost;Database=Autopark;User Id=sa;Password=your_password;TrustServerCertificate=True;"
```

## Структура генерируемых данных

Утилита создает JSON файл со следующей структурой:

```json
{
  "enterprises": [
    {
      "id": "guid",
      "name": "Название предприятия",
      "address": "Полный адрес",
      "vehicles": [
        {
          "id": "guid",
          "name": "Название машины",
          "price": 1500000.0,
          "mileageInKilometers": 50000,
          "color": "Белый",
          "registrationNumber": "А123БВ777",
          "brandModelId": "guid",
          "activeDriverId": "guid или null"
        }
      ],
      "drivers": [
        {
          "id": "guid",
          "userId": "guid",
          "salary": 80000.0,
          "vehicleId": "guid или null"
        }
      ]
    }
  ],
  "brandModels": [
    {
      "id": "guid",
      "brandName": "Toyota",
      "modelName": "Camry",
      "transportType": "Car",
      "fuelType": "Gasoline",
      "seatsNumber": 5,
      "maximumLoadCapacityInKillograms": 500
    }
  ],
  "users": [
    {
      "id": "guid",
      "email": "user@example.com",
      "phone": "+7-123-456-78-90",
      "isActive": true,
      "firstName": "Иван",
      "lastName": "Иванов",
      "dateOfBirth": "1990-01-01T00:00:00"
    }
  ]
}
```

## Особенности генерации

### Предприятия

- Названия генерируются как названия компаний
- Адреса включают полный адрес с улицей, городом и индексом

### Машины

- Цены от 500,000 до 5,000,000 рублей
- Пробег от 0 до 200,000 км
- Цвета: Белый, Черный, Серебристый, Красный, Синий, Зеленый, Желтый, Оранжевый, Серый, Коричневый
- Номера в российском формате (А123БВ777)
- Случайный выбор из 40+ брендов/моделей

### Бренды и модели

- Легковые автомобили (Toyota, BMW, Mercedes, Tesla и др.)
- Грузовики (Volvo, Scania, MAN и др.)
- Автобусы (Mercedes, Volkswagen, Ford и др.)
- Различные типы топлива (бензин, дизель, электричество)

### Водители

- Зарплата от 50,000 до 150,000 рублей
- Привязка к пользователям с полными данными
- Автоматическая привязка к машинам согласно соотношению

### Пользователи

- Русские имена и фамилии
- Валидные email адреса
- Российские номера телефонов
- Дата рождения от 18 до 65 лет

## Использование в тестах

Сгенерированные данные можно использовать для:

- Тестирования API endpoints
- Заполнения базы данных тестовыми данными
- Демонстрации функциональности системы
- Нагрузочного тестирования

## Примечания

- Все ID генерируются как GUID
- Данные локализованы для России (русские названия, адреса, номера)
- Seed обеспечивает воспроизводимость результатов
- Файл сохраняется в UTF-8 кодировке с поддержкой кириллицы
